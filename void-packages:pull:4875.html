<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta charset="utf-8" />
<title>Re: [voidlinux/void-packages] New package: budgie-desktop-10.2.7
 (#4875)</title>
<style>section{white-space:pre-wrap;}</style>
</head>
<body>
<main>
<h1>Re: [voidlinux/void-packages] New package: budgie-desktop-10.2.7
 (#4875)</h1>
<section id="post1">
<h5>Michael Gehring at <a href="#post1">Thu, 06 Oct 2016 11:30:10 -0700</a></h5>
Remove the .xbps files and squash everything to 1 commit.
Please try to use the release tarballs, they contain the only submodule (gvc).
It's prefered to not use variables in `homepage`
</section><section id="post2">
<h5>Jürgen Buchmüller at <a href="#post2">Thu, 06 Oct 2016 13:33:51 -0700</a></h5>
There is a release v10.2.7 at https://github.com/solus-project/budgie-desktop/archive/v10.2.7.tar.gz so there's really no need to git clone, or is there?
</section><section id="post3">
<h5>mar1n3r0 at <a href="#post3">Sat, 08 Oct 2016 01:37:29 -0700</a></h5>
@mar1n3r0 pushed 2 commits.
627f87d  New package: budgie-desktop-10.2.7
24e449b  Merge branch 'budgie-desktop' of https://github.com/mar1n3r0/void-packages into budgie-desktop
</section><section id="post4">
<h5>mar1n3r0 at <a href="#post4">Sat, 08 Oct 2016 01:45:05 -0700</a></h5>
Under no circumstance should you use GitHub generated tarballs to integrate Budgie Desktop into your project/distro/whatever-it-is. These tarballs are not correct, and are not supported by the maintainer.
If we determine your package uses GitHub generated tarballs, or bypasses our own release and build processes, your bug will be invalidated and no support will be received.
Note that a valid generated tarball for use from git can be generated and hosted in your own infrastructure as follows:
./autogen.sh
make distcheck
@ebfe What do you mean by remove .xbps files ?
Also I tried squashing my last commits but they doubled. I used this command:
git reset --soft HEAD~4 &amp;&amp;
git commit
</section><section id="post5">
<h5>Michael Gehring at <a href="#post5">Sat, 08 Oct 2016 01:47:39 -0700</a></h5>
There are non automatically generated release tarballs at https://github.com/solus-project/budgie-desktop/releases/download/v10.2.7/budgie-desktop-10.2.7.tar.xz.
</section><section id="post6">
<h5>Michael Gehring at <a href="#post6">Sat, 08 Oct 2016 01:48:59 -0700</a></h5>
&gt; @ebfe What do you mean by remove .xbps files ?
the first commit (947e3c3) adds .xbps files in hostdir/binpkgs
</section><section id="post7">
<h5>mar1n3r0 at <a href="#post7">Sat, 08 Oct 2016 01:50:16 -0700</a></h5>
Please see previous discussion on this:
https://github.com/voidlinux/void-packages/pull/4398
This template makes use of the tarballs which are specifically disa-vowed of by the project authors. This should be refactored to do a git checkout so that you can ensure you actually have all of the tarball since github does not fold in the submodules.
There should be no issues with Void policy on this matter since it is still a tagged, repeatable release that is made by the upstream project, only the transport mechanism is changing.
</section><section id="post8">
<h5>Michael Gehring at <a href="#post8">Sat, 08 Oct 2016 01:52:35 -0700</a></h5>
There is a difference between autogenerated github tarballs and release tarballs that are uploaded by the maintainers...
</section><section id="post9">
<h5>mar1n3r0 at <a href="#post9">Sat, 08 Oct 2016 01:54:06 -0700</a></h5>
So is this final or just a contradiction between reviewers ? Maybe discuss with @the-maldridge and then I can refactor as per agreed decision ?
</section><section id="post10">
<h5>mar1n3r0 at <a href="#post10">Sat, 08 Oct 2016 01:57:55 -0700</a></h5>
@mar1n3r0 pushed 2 commits.
fcaef25  Merge branch 'budgie-desktop' of https://github.com/mar1n3r0/void-packages into budgie-desktop
185ebb9  Merge branch 'budgie-desktop' of https://github.com/mar1n3r0/void-packages into budgie-desktop
</section><section id="post11">
<h5>Michael Gehring at <a href="#post11">Sat, 08 Oct 2016 01:58:16 -0700</a></h5>
I don't know which tarballs you used in the initial PR and the commit is gone so i can't check. Maybe you used the autogenerated one and the real release tarball was overlooked.
</section><section id="post12">
<h5>Michael Gehring at <a href="#post12">Sat, 08 Oct 2016 02:16:21 -0700</a></h5>
git rebase -i origin/master
assuming origin is the remote you use for https://github.com/voidlinux/void-packages
drop the commits that add .xbps files, squash the rest.
</section><section id="post13">
<h5>mar1n3r0 at <a href="#post13">Sat, 08 Oct 2016 03:24:58 -0700</a></h5>
[DEBUG] Added `libtls10-2.3.6_1' into the dependency list (/host/binpkgs)
libcrypto37-2.3.6_1 (update) breaks installed pkg `libressl-2.3.8_1'
libssl38-2.3.6_1 (update) breaks installed pkg `libressl-2.3.8_1'
Transaction aborted due to unresolved dependencies.
I guess the bot is currently building some packages.
</section><section id="post14">
<h5>Michael Gehring at <a href="#post14">Sat, 08 Oct 2016 03:42:05 -0700</a></h5>
&gt; I guess the bot is currently building some packages.
No, you probably need to run `./xbps-src update-bootstrap` to update your masterdir
</section><section id="post15">
<h5>mar1n3r0 at <a href="#post15">Sat, 08 Oct 2016 03:55:54 -0700</a></h5>
Hmm I ran it and it updated but it seems like the required ones are behind the installed ones, now that I think of it.
</section><section id="post16">
<h5>mar1n3r0 at <a href="#post16">Sat, 08 Oct 2016 07:06:58 -0700</a></h5>
This is solved now thanks to @Duncaen. Basically I had to pull latest changes in masterdir first.
Here is what happens next:
ERROR: [trans] failed to download wget-1.18_1' package fromhttps://repo.voidlinux.eu/current/aarch64': Not Found
[DEBUG] [trans] failed to download binpkgs: Device or resource busy
</section><section id="post17">
<h5>Michael Aldridge at <a href="#post17">Sat, 08 Oct 2016 08:53:03 -0700</a></h5>
As long as the build is repeatable and is compliant with policy I don't care how the files are retrieved.
</section><section id="post18">
<h5>mar1n3r0 at <a href="#post18">Sun, 09 Oct 2016 06:35:50 -0700</a></h5>
@mar1n3r0 pushed 2 commits.
026b885  New package: bugdie-desktop-10.2.7
91efcc7  New package: budgie-desktop-10.2.7
</section><section id="post19">
<h5>mar1n3r0 at <a href="#post19">Sun, 09 Oct 2016 06:48:48 -0700</a></h5>
@mar1n3r0 pushed 2 commits.
891776d  New package: budgie-desktop-10.2.7
b2d8232  New package: budgie-desktop-10.2.7
</section><section id="post20">
<h5>Michael Gehring at <a href="#post20">Sun, 09 Oct 2016 06:49:27 -0700</a></h5>
ebfe requested changes on this pull request.
Please squash to one commit.
&gt; +version=10.2.7
+revision=1
+build_style=gnu-configure
+hostmakedepends="wget automake gtk-doc pkg-config intltool libtool gobject-introspection"
+makedepends="libglib-devel gtk+3-devel
+libpeas-devel pulseaudio-devel gnome-desktop-devel
+mutter-devel gnome-menus-devel libwnck-devel
+libupower-glib1 vala libuuid-devel polkit-devel
+gettext-devel"
+depends="gnome-session"
+short_desc="Budgie desktop"
+maintainer="Frankie Wilde &lt;train_me_well@abv.bg&gt;"
+license="GPL-2, LGPL-2.1"
+homepage="https://github.com/solus-project/budgie-desktop"
+do_fetch() {
+	wget --no-check-certificate https://github.com/solus-project/budgie-desktop/releases/download/v${version}/${package}-${version}.tar.xz
no need to do this manually, just add it to distfiles.
&gt; +libpeas-devel pulseaudio-devel gnome-desktop-devel
+mutter-devel gnome-menus-devel libwnck-devel
+libupower-glib1 vala libuuid-devel polkit-devel
+gettext-devel"
+depends="gnome-session"
+short_desc="Budgie desktop"
+maintainer="Frankie Wilde &lt;train_me_well@abv.bg&gt;"
+license="GPL-2, LGPL-2.1"
+homepage="https://github.com/solus-project/budgie-desktop"
+do_fetch() {
+	wget --no-check-certificate https://github.com/solus-project/budgie-desktop/releases/download/v${version}/${package}-${version}.tar.xz
+	cd "${wrksrc}"
+	tar -xjvf "${pkgname}-${version}.tar.xz"
+}
+pre_configure() {
+	./autogen.sh
probably can be dropped. the release tarball already contains a configure script.
</section><section id="post21">
<h5>mar1n3r0 at <a href="#post21">Sun, 09 Oct 2016 07:02:24 -0700</a></h5>
If I only knew how to do squashing properly. In this pull request I have 12 commits but when I choose git rebase -i HEAD~12 I see all commits on the upstream repository rather than only mine. After various attempts I am now brought to cherry-picking...
</section><section id="post22">
<h5>Michael Gehring at <a href="#post22">Sun, 09 Oct 2016 07:06:25 -0700</a></h5>
```
git fetch origin
git rebase -i origin/master
```
assuming origin is the remote you use for https://github.com/voidlinux/void-packages
drop the commits that add .xbps files, squash the rest.
</section><section id="post23">
<h5>Jürgen Buchmüller at <a href="#post23">Sun, 09 Oct 2016 07:06:46 -0700</a></h5>
FWIW here is a [template that works](http://sprunge.us/HHhb) and should be correct.
I could just push it and make it close this PR?
</section><section id="post24">
<h5>mar1n3r0 at <a href="#post24">Sun, 09 Oct 2016 07:08:56 -0700</a></h5>
Yes, please do.
I feel a bit lost after diverting from my basic workflow with git.
</section><section id="post25">
<h5>Jürgen Buchmüller at <a href="#post25">Sun, 09 Oct 2016 07:10:10 -0700</a></h5>
Closed #4875 via 27e2bdf5c00cc8777c921e9fd142fc42714b8d46.
</section><section id="post26">
<h5>Michael Gehring at <a href="#post26">Sun, 09 Oct 2016 07:11:06 -0700</a></h5>
@mar1n3r0 HEAD~12 is probably not working like you think it does. Take a look at `man gitrevisions`.  @pullmoll Thanks :)
</section><section id="post27">
<h5>mar1n3r0 at <a href="#post27">Sun, 09 Oct 2016 07:17:29 -0700</a></h5>
Even git rebase -i origin/master doesn't work as I think. When I execute it basically I see hundreds of commits which are not mine.
</section><section id="post28">
<h5>mar1n3r0 at <a href="#post28">Sun, 09 Oct 2016 07:18:17 -0700</a></h5>
Thanks guys for your help and patience, this is my first package and still learning git.
</section><section id="post29">
<h5>Jürgen Buchmüller at <a href="#post29">Sun, 09 Oct 2016 07:23:17 -0700</a></h5>
FWIW here's my scheme to prepare and handle a git PR.
Do this once in your fork.
```
git remote add upstream git://github.com/voidlinux/void-packages.git
```
Now for a new package
```
git pull --rebase upstream master
git checkout -b mystuff
{ work on it and add files }
git add srcpkgs/mystuff
git commit
git push
{ more changes }
git add srcpkgs/mystuff
git commit --amend
git push -f
{ rebase to upstream master again, if there were changes like common/shlibs }
git pull --rebase upstream master
git push -f
```
</section><section id="post30">
<h5>mar1n3r0 at <a href="#post30">Sun, 09 Oct 2016 07:50:45 -0700</a></h5>
Thanks that goes straight to my how-to articles.
I was doing the fetch upstream rather than pull, maybe this is why it was outdated.
</section><section id="post31">
<h5>Toyam Cox at <a href="#post31">Tue, 11 Oct 2016 07:55:54 -0700</a></h5>
Fetch downloads the upstream, but doesn't combine it with any branch. You need to manually merge or rebase for that to happen. Pull simply does a fetch and a merge all in one.
</section>
</main>
<nav><a href="index.html">Issues list</a></nav>
</body>
</html>
